<!DOCTYPE html>
<html lang="ru-BY" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# fb: http://ogp.me/ns/fb#">
<head>
  
    <title>Почему все считают неправильно?</title>
  

  <meta name="generator" content="Hugo 0.86.1" />

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


    
        
        <meta name="description" content="Вот задался я таким вопросом и сейчас объясню суть проблемы. Примером возьмем твиттер, хотя подойдет и любой другой сервис или сайт, или даже программа.
Проблема заключается в алгоритме подсчета активности пользователя - т.е. сколько он чего сделал в определенный промежуток времени.">
        
    




<link rel="canonical" href="https://klimchuk.by/notes/counting-incorrect/">

<meta name="author" content="Ivan Klimchuk <ivan@klimchuk.com>">

<link rel="alternate" type="application/rss+xml" title="Иван Климчук. Заметки" href="https://klimchuk.by/index.xml">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<link rel="preconnect" href="https://mc.yandex.ru">






    


<link href="https://klimchuk.by/css/theme.min.a2f9ea4e6747d9b7217a021754301d508c1966b0cf3a6be45dcc1c493a3077c1.css" rel="stylesheet" type="text/css">

<script>
    
    document.addEventListener('DOMContentLoaded', () => {
        const $nbBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
        if ($nbBurgers.length < 1) {
            return;
        }
        $nbBurgers.forEach( el => {
            el.addEventListener('click', () => {
                const target = el.dataset.target;
                const $target = document.getElementById(target);
                el.classList.toggle('is-active');
                $target.classList.toggle('is-active');
            });
        });
    });
</script>


<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(53330836, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
    });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/53330836" style="position:absolute; left:-9999px;" alt="" /></div></noscript>




<meta name="yandex-verification" content="97cfe04c3aabe4cd" />


<meta name="yandex-verification" content="ab43473b398804d8" />


  
    <meta property="article:author" content="Иван Климчук">
    
        
        
            <meta property="article:section" content="Мысли">
        
    


  <meta property="og:title" content="Почему все считают неправильно?" />
<meta property="og:description" content="Вот задался я таким вопросом и сейчас объясню суть проблемы. Примером возьмем твиттер, хотя подойдет и любой другой сервис или сайт, или даже программа.
Проблема заключается в алгоритме подсчета активности пользователя - т.е. сколько он чего сделал в определенный промежуток времени." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://klimchuk.by/notes/counting-incorrect/" /><meta property="og:image" content="https://klimchuk.by/iam-1000.jpg"/><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2010-07-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2010-07-05T00:00:00+00:00" /><meta property="og:site_name" content="Иван Климчук" />


  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://klimchuk.by/iam-1000.jpg"/>

<meta name="twitter:title" content="Почему все считают неправильно?"/>
<meta name="twitter:description" content="Вот задался я таким вопросом и сейчас объясню суть проблемы. Примером возьмем твиттер, хотя подойдет и любой другой сервис или сайт, или даже программа.
Проблема заключается в алгоритме подсчета активности пользователя - т.е. сколько он чего сделал в определенный промежуток времени."/>

</head>
<body>
  <header class="section">
  <div class="container">
    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://klimchuk.by/">
          <figure class="image is-64x64 is-square is-hidden-touch">
            <img src="/iam-64.jpg" srcset="/iam-128.jpg 2x" alt="Иван Климчук" class="is-rounded">
          </figure>

          <div class="media is-hidden-desktop">
            <div class="media-left">
              <figure class="image is-48x48 is-square">
                <img src="/iam-64.jpg" srcset="/iam-128.jpg 2x" alt="Иван Климчук" class="is-rounded">
              </figure>
            </div>
          </div>
          <strong class="title is-5 is-hidden-desktop">Иван Климчук</strong>
        </a>
        <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navigation">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>

      <div id="navigation" class="navbar-menu">
        <div class="navbar-start">
          
          
          <a href="https://klimchuk.by/notes/" class="navbar-item">
            <span class="navbar-item-name">Заметки</span>
          </a>
          
          <a href="https://klimchuk.by/places/" class="navbar-item">
            <span class="navbar-item-name">Места</span>
          </a>
          
          <a href="https://klimchuk.by/projects/" class="navbar-item">
            <span class="navbar-item-name">Проекты</span>
          </a>
          
          <a href="https://klimchuk.by/talks/" class="navbar-item">
            <span class="navbar-item-name">Выступления</span>
          </a>
          
        </div>

        <div class="navbar-end">
          <div class="navbar-item">
            
              <a href="https://github.com/Alroniks" class="navbar-item is-size-5 ">
                <span class="icon is-hidden-touch"><ion-icon name="logo-github"></ion-icon></span><span class="is-hidden-desktop">&nbsp;GitHub</span>
              </a>
            
              <a href="https://www.linkedin.com/in/ivanklimchuk/" class="navbar-item is-size-5 ">
                <span class="icon is-hidden-touch"><ion-icon name="logo-linkedin"></ion-icon></span><span class="is-hidden-desktop">&nbsp;LinkedIn</span>
              </a>
            
          </div>
        </div>
      </div>
    </nav>
  </div>
</header>

  <div class="main section">
      
<div class="container">
    <div class="columns is-mobile-columns">
        <div class="column is-8">
            <article class="post">
                <header class="subtitle is-spaced">
                    <div class="breadcrumb above-title is-size-5-desktop is-size-6-mobile">
                        <ul>
                            <li><a href='https://klimchuk.by/notes/'>&larr; Все заметки</a></li>
                            
                                
                                
                                    <li><a href="https://klimchuk.by/categories/opinion/">Мысли</a></li>
                                
                            
                        </ul>
                    </div>
                    <h1 class="title is-2 is-size-3-mobile is-spaced">Почему все считают неправильно?</h1>

<div class="has-text-grey is-mobile-columns">
    
    

    
    
        <time datetime='07-05-2010 00:00:00'>5 июля 2010</time>
    
</div>

                </header>
                <div class="content">
                    

                    <p>Вот задался я таким вопросом и сейчас объясню суть проблемы. Примером возьмем твиттер, хотя подойдет и любой другой сервис или сайт, или даже программа.</p>
<p>Проблема заключается в алгоритме подсчета активности пользователя - т.е. сколько он чего сделал в определенный промежуток времени. Все, как правило, поступают следующим образом: берется текущая дата, дата регистрации или начала активности пользователя, считается количество дней в этом промежутке и количество действий делится на количество дней, получаем результат - столько-то пунктов в день. Это обычное среднее арифметическое и в целом оно отражает верную картину, но не совсем.</p>
<p>Рассмотрим пример. Вот завел я себе твиттер, написал первый твитт и забыл о сайте на месяц, а потом вспомнил и стал активным пользователем. Рассчитанное среднее арифметическое упорно твердит мне, что я делаю 2 твитта в день, хотя на самом деле количество иногда достигает 10 или более. Понятно, что таким образом сглаживаются острые пиковые значения, но если я действительно оставляю каждый день 5 твиттов в течении недели, а потом опять замолкаю. Получается что в данный момент показатель неверен, как неверен и потом, когда я молчу. Я же тогда не пишу ничего, но показатель не на ноле.</p>
<h2 id="проблемы">Проблемы</h2>
<p>Ясное дело, что посчитать среднее арифметическое до безобразия просто и даже работая с базой данных, приходится выполнять не так много запросов и вообще действий в программе, чтобы получить требуемое значение. Более сложный алгоритм работал бы медленнее. Не желание правильно считать терпимо для таких гигантов, как твиттер или другие социальные сети. Но минус в том, что с популярных сервисов все копируют не особо задумываясь, как улучшить копию. Это отдельная тема, почему там происходит.</p>
<p>Еще одной проблемой можно считать то, что для реализации более сложного алгоритма требуются хорошие познания в математике, если требуется решить задачу эффективно, что собственно удорожает разработку. Но я считаю эту проблему некритической, так как тут скорее важны объемы обрабатываемых данных. Потому что для среднего арифметического нам достаточно получить время первой активности и количество записей в БД за это время, т.е. всего 2 значения из БД и получить текущее время средствами языка программирования или самой БД. Итого выходит всего 3 значения, а если разрабатывать сложный алгоритм, нам нужно знать пики активности, спады и другие параметры, что замедлит работу. В этом заключается вторая проблема - неприменимость к существующим средствам хранения данных.</p>
<h2 id="решение">Решение</h2>
<p>Есть более просто решение, которое не решит задачу полностью, но будет отражать более правильную картину. На каждом сервисе можно приблизительно посчитать среднее время реакции пользователей. Не знаю как правильно это назвать, но приведу пример для сравнения: ответ на форуме приходится ждать от нескольких часов до нескольких дней, в социальной сети чуть быстрее, в сервисах мгновенного обмена сообщениями - почти сразу же. Таким образом мы можем предположить, какое время отклика пользователя у нас на сайте. Зная это время мы можем рассчитать активность более точно.</p>
<p>На твиттере данные обновляются довольно часто, но у нас в условии изначально стояла задача - получить активность за день. Самый простой способ - взять текущий день, получить количество твиттов за этот день и вот вам активность, но она не будет отражать правды. Для такого случая одного дня не достаточно, нужно немного расширить временные границы. Узнать, до какой степени расширять диапазон, можно, основываясь на показателе времени отклика. Если у нас форум, то можно считать посты за последнюю неделю, если социальная сеть, то за несколько дней, если это сервис IM - то вообще за несколько часов или минут. Идея, я думаю, ясна.</p>
<p>Такая реализация мало чем отличается от реализации с крайними границами и средним арифметическим, но возможно будет работать быстрее, так как нам не нужно узнавать дату первой активности, мы ее можем получить просто вычетом длины диапазона из текущего времени.</p>
<h2 id="итог">Итог</h2>
<p>Что в итоге? В итоге, с теми же малыми затратами на ресурсы мы получаем более точную информацию об активности пользователя. Если я 3 дня подряд писал по 10 твиттов, а потом замолк на неделю, то мой показатель активности постепенно упадет до 0 и это будет правдой, так как он будет показывать, что последние дни я ничего не пишу.</p>
<p>Если у вас возникли вопросы или есть чем поделиться, пишите в комментариях. Я с радостью пообщаюсь на эту тему.</p>

                </div>
                <div class="tags are-medium">
                    <span class="tag">На чтение понадобилось 4 минуты</span>
                    <span class="tag">В заметке 667 слов</span>
                </div>

                <aside class="menu under-post-navigation">
                    <ul class="menu-list is-flex is-mobile-columns">
                        
                        <li><a href="https://klimchuk.by/notes/round-table-on-rails-in-minsk/">&larr; Завершился круглый стол по Rails в Минске</a></li>
                        
                        
                        <li><a href="https://klimchuk.by/notes/jump-off-the-bridge/">Прыжок с моста на радиаторном &rarr;</a></li>
                        
                    </ul>
                </aside>

                
                <script src="https://utteranc.es/client.js"
    repo="Alroniks/compiled-klimchukby"
    issue-term="title"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>



            </article>
        </div>
        <div class="column is-1 is-hidden-mobile"></div>
        <div class="column is-3">
            <aside class="menu">

                <div class="toc is-hidden-mobile">
                
                    
                        <div class="menu-label is-size-6">Быстрая навигация</div>
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#проблемы">Проблемы</a></li>
    <li><a href="#решение">Решение</a></li>
    <li><a href="#итог">Итог</a></li>
  </ul>
</nav>
                    
                
                </div>

                

                
                    <div class="menu-label is-size-6">Похожие заметки</div>
                    <ul class="menu-list">
                        
                            <li><a href="/notes/wrong-tools-and-procrastination/">Неправильные инструменты и прокрастинация</a></li>
                        
                            <li><a href="/notes/automatism/">Автоматизм</a></li>
                        
                            <li><a href="/notes/inertia-thoughts/">Инерция мысли</a></li>
                        
                            <li><a href="/notes/books/">Книги</a></li>
                        
                            <li><a href="/notes/stereotypes/">Стереотипы</a></li>
                        
                            <li><a href="/notes/social-networks-and-time/">Социальные сети и время</a></li>
                        
                            <li><a href="/notes/good-and-evil/">Добро и зло. Что это?</a></li>
                        
                            <li><a href="/notes/hypocrisy-lives-in-each/">Лицемерие живет в каждом</a></li>
                        
                            <li><a href="/notes/real-names-and-anonymity-online/">Настоящие имена и анонимность в сети</a></li>
                        
                            <li><a href="/notes/time-money-save/">Время = Деньги. Экономить?</a></li>
                        
                    </ul>
                
            </aside>
        </div>
    </div>
</div>

  </div>
  <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-left">
                <div class="level-item copy">&copy; 2010 — 2021.</div>
                <div class="level-item"><a href="/donate">Поддержать проект</a></div>
            </div>
            <div class="level-right">
                <div class="content">
                    <a target="_blank" rel="noopener" href="https://klimchuk.com">
                        klimchuk.com <sup>eng</sup>
                    </a>
                </div>
            </div>
        </div>
    </div>
</footer>



<script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>

</body>
</html>
